<html>
<head>
  <meta charset="utf-8">
  <title>Mocha Tests</title>

  <link rel="stylesheet" href="/node_modules/mocha/mocha.css" type="text/css" />

  <script src="/node_modules/jquery/jquery.js"></script>
  <script src="/node_modules/mocha/mocha.js"></script>
  <script src="/node_modules/expect.js/expect.js"></script>
  <script src="/node_modules/sinon/lib/sinon.js"></script>
  <script src="/node_modules/sinon/lib/sinon/spy.js"></script>
  <script src="/node_modules/dfrrd/lib/dfrrd.js"></script>

  <script src="/lib/repeat.js" type="text/javascript"></script>

  <script>mocha.setup('bdd')</script>

  <script src="/test/repeat.js" type="text/javascript"></script>

  <script>
    jQuery(function () {
      var currentLib = document.location.hash.substring(1);
      setInterval(function() {
        if (currentLib != document.location.hash.substring(1)) document.location.reload()
      }, 100);
;
      if (currentLib) {
        Repeat.defer = currentLib == 'jQuery' ? function() {
          console.log("Creating Deferred from "+jQuery.fn.jquery);
          return $.Deferred();
        } : function() {
          console.log("Creating Deferred from Dfrrd");
            return window.Deferred();
          };
        mocha.run();
      }
    });    
  </script>
</head>
<body>
  Run with library:
  <ul>
     <li><a href="#jQuery">jQuery</a></li>
     <li><a href="#Dfrrd">Dfrrd</a></li>
  </ul>
  <div id="mocha"></div>
</body>
</html>